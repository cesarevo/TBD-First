## <a name="3!!"></a>Многотабличные запросы

1. [Вывести все имена и фамилии студентов, и название хобби, которым занимается этот студент.](#3_1)
2. [Вывести информацию о студенте, занимающимся хобби самое продолжительное время.](#3_2)
3. [Вывести имя, фамилию, номер зачетки и дату рождения для студентов, средний балл которых выше среднего, а сумма риска всех хобби, которыми он занимается в данный момент, больше 0.9.](#3_3)
4. [Вывести фамилию, имя, зачетку, дату рождения, название хобби и длительность в месяцах, для всех завершенных хобби Диапазон дат.](#3_4)
5. [Вывести фамилию, имя, зачетку, дату рождения студентов, которым исполнилось N полных лет на текущую дату, и которые имеют более 1 действующего хобби.](#3_5)
6. [Найти средний балл в каждой группе, учитывая только баллы студентов, которые имеют хотя бы одно действующее хобби.](#3_6)
7. [Найти название, риск, длительность в месяцах самого продолжительного хобби из действующих, указав номер зачетки студента.](#3_7)
8. [Найти все хобби, которыми увлекаются студенты, имеющие максимальный балл.](#3_8)
9. [Найти все действующие хобби, которыми увлекаются троечники 2-го курса.](#3_9)
10. [Найти номера курсов, на которых более 50% студентов имеют более одного действующего хобби.](#3_10)
11. [Вывести номера групп, в которых не менее 60% студентов имеют балл не ниже 4.](#3_11)
12. [Для каждого курса подсчитать количество различных действующих хобби на курсе.](#3_12)
13. [Вывести номер зачётки, фамилию и имя, дату рождения и номер курса для всех отличников, не имеющих хобби. Отсортировать данные по возрастанию в пределах курса по убыванию даты рождения.](#3_13)
14. [Создать представление, в котором отображается вся информация о студентах, которые продолжают заниматься хобби в данный момент и занимаются им как минимум 5 лет.](#3_14)
15. [Для каждого хобби вывести количество людей, которые им занимаются.](#3_15)
16. [Вывести ИД самого популярного хобби.](#3_16)
17. [Вывести всю информацию о студентах, занимающихся самым популярным хобби.](#3_17)
18. [Вывести ИД 3х хобби с максимальным риском.](#3_18)
19. [Вывести 10 студентов, которые занимаются одним (или несколькими) хобби самое продолжительно время.](#3_19)
20. [Вывести номера групп (без повторений), в которых учатся студенты из предыдущего запроса.](#3_20)
21. [Создать представление, которое выводит номер зачетки, имя и фамилию студентов, отсортированных по убыванию среднего балла.](#3_21)
22. [Представление: найти каждое популярное хобби на каждом курсе.](#3_22)
23. [Представление: найти хобби с максимальным риском среди самых распространенных хобби на 2 уровне.](#3_23)
24. [Представление: для каждого курса подбирается количество студентов на курсе и количество отличников.](#3_24)
25. [Представление: самое популярное хобби среди всех студентов.](#3_25)
26. [Создать обновляемое представление.](#3_26)
27. [Для каждой буквы алфавита из числа найденных величин, средних и балльных. (Т.е. среди всех студентов, чьё имя начинается на А (Алексей, Алина, Артур, Анджела) найти то, что указано в задании. Вывести на экран тех, средний балл проходит больше 3,6](#3_27)
28. [Для каждой фамилии характерна высокая степень тяжести и снижение балла. (Например, в университете учатся 4 Иванова (1-2-3-4). 1-2-3 учатся на 2 курсах и имеют средний балл 4.1, 4, 3.8, соответственно, а 4 Иванов учится на 3 курсах и имеет балл 4.5. На экране должно быть следующее:](#3_28)

id | surname | max | min
---|---------|-----|----    
2  | Иванов  | 4,1 | 3,8
3  | Иванов  | 4,5 | 4,5

29. [Для каждого года рождения подсчитывается количество хобби, наблюдаемое или занимавшееся студентами.](#3_29)
30. [Для каждой буквы алфавита в большинстве случаев возникает риск, связанный с хобби.](#3_30)
31. [Для каждого месяца из-за даты рождения студентов получаются средние баллы, которые являются хобби под названием «Футбол».](#3_31)
32. [Вывести информацию о студентах, которые занимались или занимались хотя бы 1 хобби в следующем формате: Имя: Иван, фамилия: Иванов, группа: 1234](#3_32)
33. [Внешний вид в какой-то по счёту символа встречается «ов». Если 0 (т.е. не встречается, то выведите на экран «не найдено»).](#3_33)
34. [Дополнить фамилию прямым символом # до 10 символов.](#3_34)
35. [При помощи функции удалить все символы # из полученного запроса.](#3_35)
36. [Выведите на экран количество дней в прошлом 2018 году.](#3_36)
37. [Вывести на экран какого числа будет ближайшая суббота.](#3_37)
38. [Выведите на экран век, а также какая сейчас неделя года и день года.](#3_38)
39. [Вы вводите всех студентов, которые занимались хотя бы 1 хобби. Выведите на экран Имя, Фамилию, Название хобби, а также надпись «занимается», если студент продолжает заниматься хобби в данный момент или «закончил», если уже не занимается.](#3_39)
40. [Для каждой группы приводят количество студентов учится на 5,4,3,2. Использовать обычное математическое округление. Итоговый результат должен выглядеть примерно так:](#3_40)

    | СЧЕТ | 2222 | 3011 | 4011 | 4032 |
    | ----- | ---- | ---- | ---- | ---- |
    | 2 | 0 | 0 | 0 | 1 |
    | 3 | 1 | 2 | 1 | 1 |
    | 4 | 4 | 3 | 3 | 3 |
    | 5 | 1 | 1 | 1 | 0 |

<br></br>

### <a name="3_1"></a> 1. Вывести все имена и фамилии студентов, и название хобби, которым занимается этот студент.

#### `Запрос`

```SQL

SELECT stud.name, stud.surname, h.hobby_name FROM student stud
INNER JOIN student_hobby sh ON stud.n_z = sh.id
INNER JOIN hobby h ON h.id = sh.id

```

#### `Вывод`

![sql1](https://github.com/cesarevo/TBD-First/blob/08caf77588af0a4d967b873ff7ce90cfb03d9dcc/sql1.png)

<br></br>
![sql2](sql_pictures/sql2.png)






